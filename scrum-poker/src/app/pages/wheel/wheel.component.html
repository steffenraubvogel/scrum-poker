<h1>Wheel of Names</h1>

<table class="table table-hover align-middle">
  <thead>
    <tr>
      <th scope="col">Name</th>
      <th scope="col">Active</th>
      <th scope="col">Actions</th>
    </tr>
  </thead>
  <tbody>
    @for (item of items; track item.name) {
    <tr>
      <td>{{ item.name }}</td>
      <td>
        <input class="form-check-input" type="checkbox" [(ngModel)]="item.active" />
      </td>
      <td>
        <button class="btn btn-primary btn-sm" type="button" (click)="removeItem(item)">Remove</button>
      </td>
    </tr>
    } @empty {
    <tr>
      <td colspan="3">-</td>
    </tr>
    }
  </tbody>
</table>

<button class="btn btn-primary" type="button" (click)="addItem()">Add Name</button>

@if (effectiveItems.length > 1) {
<div class="wheel-container">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="-10 -10 180 120">
    @for (item of effectiveItems; track item.name; let idx = $index) {
    <g
      stroke="black"
      stroke-width="0.25"
      [attr.fill]="'hsl(' + item.color + ', 70%, 50%)'"
      [ngStyle]="{
        'transform': 'rotate(' + (360 / effectiveItems.length * idx) + 'deg)',
      }"
      transform-origin="50 50"
      class="sp-radial-chart-arc"
    >
      <path
        attr.d="M 50 50 L 50 0 A 50 50 0 0 1 {{ 50 + math.sin((2 * math.PI) / this.effectiveItems.length) * 50 }} {{
          50 - math.cos((2 * math.PI) / this.effectiveItems.length) * 50
        }} Z"
        transform-origin="50 50"
      ></path>
      <title>{{ item.name }}</title>
    </g>

    <g [ngStyle]="{'transform': 'rotate(' + (360 / effectiveItems.length * (idx + 0.5)) + 'deg)',}" transform-origin="50 50">
      <text
        [attr.x]="50"
        [attr.y]="5"
        style="font-size: 8px"
        [attr.stroke]="'hsl(' + item.color + ', 70%, 25%)'"
        stroke-width="0.2"
        fill="white"
        text-anchor="end"
        dominant-baseline="middle"
        transform-origin="50 5"
        transform="rotate(-90)"
      >
        {{ item.name }}
      </text>
    </g>
    }

    <circle cy="50" r="2" cx="50" fill="black"></circle>
  </svg>
</div>
}
